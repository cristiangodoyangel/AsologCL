---
---

<section class="section bg-secondary" id="cotizador">
  <div class="container cotizador-container">
    
    <div class="cotizador-info">
      <h2 class="title">Cotiza tu Envío</h2>
      <p class="description">
        Obtén una estimación rápida para tu carga. Ingresa las dimensiones y peso para calcular el peso volumétrico y recibir una aproximación de nuestros servicios.
      </p>
      
      <div class="info-card">
        <h3 class="info-title">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
          </svg>
          ¿Cómo funciona?
        </h3>
        <p class="info-text">
          El costo del envío se calcula considerando tanto el peso real como el peso volumétrico (espacio que ocupa). Nuestra calculadora te ayuda a entender qué factor será determinante.
        </p>
      </div>

      <div class="steps-grid">
        <div class="step">
          <div class="step-number">1</div>
          <span class="step-label">Ingresa Datos</span>
        </div>
        <div class="step">
          <div class="step-number">2</div>
          <span class="step-label">Obtén el Cálculo</span>
        </div>
        <div class="step">
            <div class="step-number">3</div>
            <span class="step-label">Contáctanos</span>
          </div>
      </div>
    </div>

    <div class="cotizador-form-wrapper">
      <div class="glass-panel">
        <div class="badge">Rápido y Fácil</div>
        
        <form class="quote-form" id="quote-form">
            <!-- Peso -->
            <div class="form-group full-width">
                <label for="weight">Peso Real Aprox. (kg)</label>
                <input type="number" id="weight" name="weight" placeholder="Ej: 10" required min="0.1" step="0.1">
            </div>

            <!-- Dimensiones -->
            <div class="form-group">
                <label for="length">Largo (cm)</label>
                <input type="number" id="length" name="length" placeholder="Ej: 50" required min="1">
            </div>
            <div class="form-group">
                <label for="width">Ancho (cm)</label>
                <input type="number" id="width" name="width" placeholder="Ej: 40" required min="1">
            </div>
            <div class="form-group">
                <label for="height">Alto (cm)</label>
                <input type="number" id="height" name="height" placeholder="Ej: 30" required min="1">
            </div>

             <!-- CTA Button in Form -->
            <div class="form-actions">
                <button type="submit" class="btn btn-primary btn-block">
                    Calcula tu Envío
                </button>
            </div>
        </form>

        <!-- Result Area (Hidden by default) -->
        <div id="result" class="result-area hidden">
            <div class="result-card">
                <div class="result-row">
                    <span class="result-label">Peso Volumétrico:</span>
                    <span class="result-value"><span id="volumetric-val">0</span> kg</span>
                </div>
                 <div class="result-row highlight">
                    <span class="result-label">Peso Tasable:</span>
                    <span class="result-value highlight"><span id="chargeable-val">0</span> kg</span>
                </div>
            </div>
            <p class="result-note">El peso tasable es el mayor entre el peso real y el volumétrico.</p>
            <a href="#" id="whatsapp-btn" target="_blank" class="btn btn-accent btn-block">Solicitar Cotización Formal</a>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  const form = document.getElementById('quote-form');
  const result = document.getElementById('result');
  const volValSpan = document.getElementById('volumetric-val');
  const chargeableValSpan = document.getElementById('chargeable-val');

  if (form) {
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const formData = new FormData(e.target as HTMLFormElement);
      const weight = Number(formData.get('weight'));
      const length = Number(formData.get('length'));
      const width = Number(formData.get('width'));
      const height = Number(formData.get('height'));
      
      // Volumetric weight calculation (standard formula: (L x W x H) / 5000)
      const volWeight = (length * width * height) / 5000;
      const chargeableWeight = Math.max(weight, volWeight);
      
      if(volValSpan) volValSpan.textContent = volWeight.toFixed(2);
      if(chargeableValSpan) chargeableValSpan.textContent = chargeableWeight.toFixed(2);
      
      if(result) {
        result.classList.remove('hidden');
      }

      const whatsappBtn = document.getElementById('whatsapp-btn') as HTMLAnchorElement;
      if (whatsappBtn) {
        const message = `Hola, me gustaría solicitar una cotización formal con los siguientes datos aproximados:
Peso Real: ${weight} kg
Dimensiones: ${length}x${width}x${height} cm
Peso Volumétrico: ${volWeight.toFixed(2)} kg
Peso Tasable: ${chargeableWeight.toFixed(2)} kg`;
        
        const encodedMessage = encodeURIComponent(message);
        whatsappBtn.href = `https://wa.me/56923714203?text=${encodedMessage}`;
      }
    });
  }
</script>

<style>
    .bg-secondary {
        background-color: var(--color-bg-secondary);
        position: relative;
        overflow: hidden;
    }

    .cotizador-container {
        display: flex;
        flex-direction: column;
        gap: 3rem;
    }

    @media (min-width: 992px) {
        .cotizador-container {
            flex-direction: row;
            align-items: center;
        }
    }

    .cotizador-info {
        flex: 1;
    }

    .cotizador-form-wrapper {
        flex: 1;
        width: 100%;
    }

    .title {
        font-size: 2.25rem;
        font-weight: 700;
        color: var(--color-primary-dark);
        margin-bottom: 1.5rem;
    }

    .description {
        font-size: 1.125rem;
        color: var(--color-primary-light);
        margin-bottom: 2rem;
        line-height: 1.6;
    }

    .info-card {
        background-color: white;
        padding: 1.5rem;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-sm);
        border-left: 4px solid var(--color-accent);
        margin-bottom: 1.5rem;
    }

    .info-title {
        font-weight: 700;
        color: var(--color-primary-dark);
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .icon {
        width: 1.25rem;
        height: 1.25rem;
        color: var(--color-accent);
    }

    .info-text {
        font-size: 0.875rem;
        color: var(--color-text-light);
    }

    .steps-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1rem;
    }

    .step {
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .step-number {
        width: 2.5rem;
        height: 2.5rem;
        border-radius: 50%;
        background-color: rgba(139, 195, 74, 0.2);
        color: var(--color-primary-dark);
        font-weight: 700;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
    }

    .step-label {
        font-size: 0.875rem;
        font-weight: 500;
    }

    .glass-panel {
        background: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.5);
        border-radius: var(--border-radius);
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        padding: 2rem;
        position: relative;
    }

    .badge {
        position: absolute;
        top: -1rem;
        right: -1rem;
        background-color: var(--color-accent);
        color: white;
        padding: 0.25rem 1rem;
        border-radius: 9999px;
        font-size: 0.875rem;
        font-weight: 700;
        box-shadow: var(--shadow-md);
    }

    .quote-form {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1.5rem;
    }

    @media (min-width: 768px) {
        .quote-form {
            grid-template-columns: 1fr 1fr;
        }
    }

    .form-group {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .form-group.full-width, .form-actions {
        grid-column: 1 / -1;
    }

    label {
        font-weight: 500;
        color: var(--color-primary-dark);
    }

    input {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid #e5e7eb;
        border-radius: var(--border-radius);
        background-color: rgba(255, 255, 255, 0.9);
        outline: none;
        transition: all 0.2s;
        font-family: inherit;
        font-size: 1rem;
    }

    input:focus {
        border-color: var(--color-accent);
        box-shadow: 0 0 0 3px rgba(139, 195, 74, 0.1);
    }

    .btn-block {
        width: 100%;
        padding: 1rem;
        font-size: 1.125rem;
        display: flex;
        justify-content: center;
    }

    .result-area {
        margin-top: 1.5rem;
        padding-top: 1.5rem;
        border-top: 1px solid #e5e7eb;
        animation: fadeIn 0.5s ease-out;
    }

    .hidden {
        display: none;
    }

    .result-card {
        background-color: rgba(59, 71, 45, 0.05); /* primary-dark with low opacity */
        padding: 1rem;
        border-radius: var(--border-radius);
        margin-bottom: 1rem;
    }

    .result-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.5rem;
    }

    .result-row:last-child {
        margin-bottom: 0;
    }

    .result-label {
        font-size: 0.875rem;
        color: var(--color-text-light);
    }

    .result-value {
        font-size: 1.125rem;
        font-weight: 700;
        color: var(--color-primary-dark);
    }

    .highlight .result-value {
        font-size: 1.25rem;
        color: var(--color-primary-dark); /* Using dark green as main text color */
    }

    .result-note {
        font-size: 0.75rem;
        text-align: center;
        color: var(--color-text-light);
        margin-bottom: 1rem;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>
